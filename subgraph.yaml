specVersion: 0.0.4
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: TradingCompFactory
    network: scroll-sepolia
    source:
      address: "0xF8c851446Bba8AD2F980166A01EC7693DE88f09e"
      abi: TradingCompFactory
      startBlock: 13359812
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      entities:
        - OwnershipTransferred
        - TradingCompDeployed
      abis:
        - name: TradingCompFactory
          file: ./abis/TradingCompFactory.json
        - name: ERC20
          file: ./abis/ERC20ABI.json
        - name: UniswapPair
          file: ./abis/UniswapPair.json
        - name: TradingComp
          file: ./abis/TradingComp.json

      eventHandlers:
        - event: OwnershipTransferred(indexed address,indexed address)
          handler: handleOwnershipTransferred
        - event: TradingCompDeployed(string,indexed address)
          handler: handleNewTradingComp
      file: ./src/mapping.ts

templates:
  - kind: ethereum/contract
    name: UniswapPair
    network: scroll-sepolia
    source:
      abi: UniswapPair
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      file: ./src/mappings/pair.ts
      entities:
        - UniswapPair
        - Token
        - Competition
      abis:
        - name: UniswapPair
          file: ./abis/UniswapPair.json
        - name: TradingCompFactory
          file: ./abis/TradingCompFactory.json
        - name: ERC20
          file: ./abis/ERC20ABI.json
        - name: TradingComp
          file: ./abis/TradingComp.json
      eventHandlers:
        - event: Mint(indexed address,uint256,uint256)
          handler: handleMint
        - event: Burn(indexed address,uint256,uint256,indexed address)
          handler: handleBurn
        - event: Swap(indexed address,uint256,uint256,uint256,uint256,indexed address)
          handler: handleSwap
        - event: Transfer(indexed address,indexed address,uint256)
          handler: handleTransfer
        - event: Sync(uint112,uint112)
          handler: handleSync

  - kind: ethereum/contract
    name: TradingComp
    network: scroll-sepolia
    source:
      abi: TradingComp
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.6
      language: wasm/assemblyscript
      file: ./src/mappings/competition.ts
      entities:
        - UniswapPair
        - Token
        - Competition

      abis:
        - name: TradingComp
          file: ./abis/TradingComp.json
        - name: UniswapPair
          file: ./abis/UniswapPair.json
        - name: TradingCompFactory
          file: ./abis/TradingCompFactory.json
        - name: ERC20
          file: ./abis/ERC20ABI.json
      eventHandlers:
        - event: NewCompStatus(uint8)
          handler: handleCompStatus
        - event: NewPairSet(address)
          handler: handleNewPairSet
        - event: OwnershipTransferred(indexed address,indexed address)
          handler: handleOwnershipTransfered
        - event: Register(address)
          handler: handleRegister
